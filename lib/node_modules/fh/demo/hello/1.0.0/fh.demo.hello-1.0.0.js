(function(define) { define(function(require, ex$, module) {
var $$req$ = require; require = (typeof $$ceylon$require == 'undefined') ? $$req$ : function() { return $$ceylon$require('fh/demo/hello/1.0.0/fh.demo.hello-1.0.0', $$req$, Array.prototype.slice.call(arguments)); }

var _CTM$;function $CCMM$(){if (_CTM$===undefined)_CTM$=require('fh/demo/hello/1.0.0/fh.demo.hello-1.0.0-model').$CCMM$;return _CTM$;}
ex$.$CCMM$=$CCMM$;
var m$1=require('ceylon/language/1.2.3/ceylon.language-1.2.3');
m$1.$addmod$(m$1,'ceylon.language/1.2.3');
m$1.$addmod$(ex$,'fh.demo.hello/1.0.0');
var m$2=m$1.npm$req('express','express/index.js',require);
m$1.$addmod$(m$2,'express/4.0.0');
var m$3=m$1.npm$req('cors','cors/./lib/index.js',require);
m$1.$addmod$(m$3,'cors/2.2.0');
var m$4=m$1.npm$req('bodyParser','body-parser/index.js',require);
m$1.$addmod$(m$4,'body-parser/1.0.2');
var m$5=require('my/express/1.0.0/my.express-1.0.0');
m$1.$addmod$(m$5,'my.express/1.0.0');
var m$6=m$1.npm$req('fhMbaasApi','fh-mbaas-api/lib/api.js',require);
m$1.$addmod$(m$6,'fh-mbaas-api/5.12.0');
ex$.$mod$ans$=function(){return[m$1.$_native(m$1.$arr$sa$(["js"],{t:m$1.$_String}))];};
ex$.$mod$imps=function(){return{
'my.express/1.0.0':[],
'express/4.0.0':[],
'body-parser/1.0.2':[],
'cors/2.2.0':[],
'fh-mbaas-api/5.12.0':[]
};};
function helloRoute(){
var $9;
var $a=new m$2.Router();
$9=m$1.dre$$($a,{t:m$5.Router},'hello.ceylon 10:16-10:21');$9.use(m$1.ndtc$(m$3.cors(),{t:m$1.Anything},'hello.ceylon 11:18-11:23'));
$9.use(m$1.ndtc$(m$4.bodyParser(),{t:m$1.Anything},'hello.ceylon 12:18-12:29'));
$9.get("/",m$1.$JsCallable((function($b,$c){
var $d=m$1.ndtc$(($e=($f=$b.query,m$1.nn$($f)?$f.hello:null),m$1.nn$($e)?$e:"World"),{t:m$1.$_String},'hello.ceylon 19:27-19:55');
$prop$get$d={$crtmm$:function(){return{mod:$CCMM$,$t:{t:m$1.$_String},$cont:helloRoute,d:['fh.demo.hello','helloRoute','$at','world$fjrelp']};}};
$prop$get$d.get=function(){return $d};
m$1.print("In hello route GET / ".plus($d));
$c.json({msg:"Hello, ".plus($d).plus("!")});
var $e,$f;
}),[{nm:'req',mt:'prm',$t:{t:m$5.Request}},{nm:'res',mt:'prm',$t:{t:m$5.Response}}],{Return$Callable:{t:m$1.Anything},Arguments$Callable:m$1.mtt$([{t:m$5.Request},{t:m$5.Response}])}));
$9.post("/",m$1.$JsCallable((function($g,$h){
var $i=m$1.ndtc$(($j=($k=$g.body,m$1.nn$($k)?$k.hello:null),m$1.nn$($j)?$j:"World"),{t:m$1.$_String},'hello.ceylon 32:27-32:54');
$prop$get$i={$crtmm$:function(){return{mod:$CCMM$,$t:{t:m$1.$_String},$cont:helloRoute,d:['fh.demo.hello','helloRoute','$at','world$imskqk']};}};
$prop$get$i.get=function(){return $i};
m$1.print("In hello route POST / ".plus($i));
$h.json({msg:"Hello, ".plus($i).plus("!")});
var $j,$k;
}),[{nm:'req',mt:'prm',$t:{t:m$5.Request}},{nm:'res',mt:'prm',$t:{t:m$5.Response}}],{Return$Callable:{t:m$1.Anything},Arguments$Callable:m$1.mtt$([{t:m$5.Request},{t:m$5.Response}])}));
return $9;
};helloRoute.$crtmm$=function(){return{mod:$CCMM$,$t:{t:m$5.Router},ps:[],d:['fh.demo.hello','helloRoute']};};
function run(){
var $l=($m=m$1.parseInteger(($n=($o=m$1.$_process().environmentVariableValue("FH_PORT"),m$1.nn$($o)?$o:m$1.$_process().environmentVariableValue("OPENSHIFT_NODEJS_PORT")),m$1.nn$($n)?$n:"Missing option")),m$1.nn$($m)?$m:(8001));
var $m,$n,$o;
var $p=($q=m$1.$_process().environmentVariableValue("OPENSHIFT_NODEJS_IP"),m$1.nn$($q)?$q:"0.0.0.0");
var $q;
var $r;
var $s;
$r=m$1.dre$$(m$2.express(),{t:m$5.ExpressApp},'run.ceylon 15:14-15:22');$s=m$1.dre$$(m$6.mbaasExpress(),{t:m$5.MbaasExpress},'run.ceylon 16:20-16:33');$r.use(m$1.ndtc$(m$3.cors(),{t:m$1.Anything},'run.ceylon 18:16-18:21'));
var $t=["/hello"];
$r.use("/sys",m$1.ndtc$($s.sys($t),{t:m$1.Anything},'run.ceylon 22:24-22:56'));
$r.use("/mbaas",$s.mbaas);
$r.use($s.fhmiddleware());
$r.use("/hello",helloRoute());
$r.use($s.errorHandler());
$r.listen($l,$p,m$1.$JsCallable((function(){return m$1.print("App listening on port ".plus($l.string));
}),[],{Return$Callable:{t:m$1.Anything},Arguments$Callable:{t:m$1.Empty}}));
}
ex$.run=run;
run.$crtmm$=function(){return{mod:$CCMM$,$t:{t:m$1.Anything},ps:[],pa:1,d:['fh.demo.hello','run']};};
ex$.$pkg$ans$fh$demo$hello=function(){return[m$1.shared()];};
ex$.$pkgunsh$fh$demo$hello={'helloRoute':helloRoute};
});
}(typeof define==='function' && define.amd ? define : function (factory) {
if (typeof exports!=='undefined') { factory(require, exports, module);
} else { throw 'no module loader'; }
}));
